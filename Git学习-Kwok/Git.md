# 关于Git

> 一知半解的使用Git和Github很久了，也挺难受的。所以这次跟着[廖雪峰老师的Git教程](https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000)对Git进行一次系统的了解和学习。

## Git是从哪里来的？

Linus在1991年创建了开源的Linux，之后Linux项目依赖大量的社区成员的贡献得以不断壮大。而那么多志愿者为Linux系统编写代码，Linux系统的代码管理却依靠的是Linux本人来手动合并志愿者的代码。
> “你也许会想，为什么Linus不把Linux代码放到版本控制系统里呢？不是有CVS、SVN这些免费的版本控制系统吗？因为Linus坚定地反对CVS和SVN，这些集中式的版本控制系统不但速度慢，而且必须联网才能使用。有一些商用的版本控制系统，虽然比CVS、SVN好用，但那是付费的，和Linux的开源精神不符。”   -- 廖雪峰

后来，这种手工合并的方式随着Linux系统的越发庞大变得难以为继，Linux选择了一个商业的版本控制系统BitKeeper，并且该系统的东家BitMover也很nice的授权Linux社区免费使用该系统。再后来，Linux社区牛人手痒痒试图破解BitKeeper的协议被BitMover公司发现了，该公司威胁收回Linux社区的免费使用权。

最后，据说Linux花了两星期写出了Git。  
...

Git迅速火了，08年Gayhub推出，为开源项目免费提供Git存储。Gayhub现在的影响力，大家也很清楚了。就酱。

> 注：SVN是集中式的版本控制系统，Git是分布式版本控制系统。集中式是指将版本库存放在中央服务器，你要修改，先联网获取最新的版本，然后修改后再推送到中央服务器。中央服务器出个问题大家都可以下班了。而对于分布式来说，每个人的电脑都是一个版本库，协作的时候是把修改互相推送给对方，通常也有一个中央服务器，但这个服务器的作用只是方便大家交换自己的修改，没有它一样可以工作。

## 配置一下Git
1. [官网](https://git-scm.com/)下载，打不开就随便百度一个下载。安装时一路Next即可。各个选项什么意思这里先不细说了。
2. 命令行敲一下`git --version`，看看是不是已经安装了。顺便看看当前版本。
3. 简单配置一下：
    ``` Git
    $ git config --global user.name "Your Name"
    $ git config --global user.email "email@example.com"
    ```
    意思是什么呢，就是在你提交你的改动的时候，别人可以知道这是谁提交的。`global`就是针对本机所有仓库进行设置，对单个仓库进行特殊设置当然也是可以的了。定位到仓库，把`global`去了即可。

## 可以开始使用Git啦

#### 版本库的创建
1. 新建文件夹。为了避免不必要的问题，路径最好不要有中文。
2. 命令行定位到文件夹（嫌输路径麻烦的，文件夹内`Shift+鼠标右键`，打开命令行/Powershell即可），执行`git init`。
3. 会有一个隐藏文件夹`git`生成，就是Git用来管理版本库的，不要乱动。

#### 关于可以管理的文件
纯文本文件。其他不可以。
- 视频不可以。
- 图片不可以。
- Word文档不可以，因为它是二进制的。

所以，选一个好点的文字编辑器吧。以下均支持Markdown（可能需要安装插件）。
- 强烈推荐Visual Studio Code。写代码，编辑文本都很好，官方免费。
- Sublime，不怎么写代码的话，这个启动速度很快。即使是写一些代码，它也是一个很不错的选择。
- 其他如Atom什么的。如果要求比较细致的话，自己都去试试，做做对比，这个话题在此打住。

## 让我们提交一个文件到版本库

先说几条指令：
|命令|意义|
|--|--|
|`git init`|之前说过，初始化一个Git仓库
|`git status`  |查看仓库文件状态，比如什么文件你创建了还没被添加，什么文件你添加了还没提交。
|`git add yourfile.xx`|添加一个文件到仓库
|`git commit -m "your commit message"`|提交改动。一定要写信息，这里就不要偷懒了。不写信息的话会也报错。坚持不想写，自己去查怎么做吧。
|`git log`|看看提交历史。

目前，一个完整的提交流程是这样的，以一个`readme.md`为例：
1. 新建文件夹
2. 对文件夹执行`git init`
3. 新建文件`readme.md`
4. 可以使用`git status`查看仓库里的文件状态，这时会显示你刚才新建的文件状态为`Untracked`，需要`add`
5. `git add readme.md`，将`readme.md`文件添加到仓库里。
6. `git commit -m "girlfriend committed"`，提交。

## 开始管理仓库啦

#### 提交修改
我们修改下`readme.md`文件。比如加几句话。
1. 这时使用`git status`，会显示文件是被修改状态`modified`
2. 使用`git diff`可以查看改动了什么内容。
3. `git add`&`git commit -m""`提交修改。
4. 这时使用`git status`，会显示文件是被修改状态`working tree clean`，工作区很干净啊，什么都处理好了。

#### 版本回退
1. 你自己重复做一些提交操作。
2. `git log`查看提交历史
3. git中当前版本为`HEAD`，上一个`HEAD^`，上上个`HEAD^^`，或者`HEAD^2`，同理，`HEAD^100`表示往上100个版本。
4. `git reset --hard^`可以回到上个版本。同理回到其他版本。
5. 查不过来？那就对着`git log`看log信息`commit`后边跟着的16进制数字，就是`commitId`，记下来使用`git reset --hard commitId`来会到那个版本，亲测输前四位已经可以了，但为了避免万一出现重复的情况，多输几位更稳妥些。
6. 后悔回退了？输`git log`也找不到新版本的提交信息了，那怎么办？`git reflog`帮你，这个命令可以记录你所有操作的commitId，现在再次使用`git reset --hard commitId`回到未来吧。

#### 撤销修改
1. `git checkout filename`，用于对文件的修改还没有被应用，则可以返回之前一次`add`或`commit`后的版本，哪个近算哪个。什么意思呢？你执行了该命令，就去暂存区里找一下，有就给你还原，没有就去版本库里找一下，有就还原。具体就是下面两种情况：
    - 在执行过`commit`之后，你做了改动，但是还没有执行`add`命令，这时使用`checkout`可以撤销修改，回到刚`commit`后时的状态。
    - 上个操作是`add`，之后做了改动，不想要了，可以使用`checkout`，这时候是回到刚`add`之后的状态。
2. `git reset HEAD filename`，这个命令适用于，你`add`了文件，但没有提交，你想回到文件最近一次`commit`后的状态，这个命令就可以把文件恢复到版本库中最新版本。
3. `commit`后后悔了？参考版本回退吧。

#### 删除
1. 从git版本库删除，你说这个文件我不放在版本库了。这时候有一个问题，那就是你本地还要么？
    - 要，那就使用`git rm filename --cached`这样就像你刚自己创建了一个一摸一样的文件一样。使用`git status`可以看到这个文件状态是`Untracked`未缓存，暂存区没相关信息。
    - 不要，那就使用`git rm filename`，如果你做过修改则可以在后边加上`-f`来执行强制操作，即force。
2. 删除后可以使用`git reset HEAD filename`结合`git checkout filename`来还原到版本库最新的版本，
3. 无论怎样你都是可以从版本库里还原之前提交过的版本的。但是注意一些未提交的改动会丢失。


## 远程仓库

#### Github
github使用SSH协议来确定你推送的内容确实是你推送的，而不是别人冒名顶替的。

> 待续...

